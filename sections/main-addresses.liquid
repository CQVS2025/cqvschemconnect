<section class="addresses-page">
  <div class="container">

    <h1 class="addresses-page__heading">{{ section.settings.heading }}</h1>

    {%- comment -%} Add new address form {%- endcomment -%}
    <div class="addresses-page__new" id="add-address">
      <h2 class="addresses-page__section-title">{{ 'customer.addresses.add_new' | t }}</h2>

      {% form 'customer_address', 'new' %}
        <div class="addresses-page__form-grid">
          <div class="addresses-page__field">
            <label for="address-new-first-name" class="addresses-page__label">{{ 'customer.addresses.first_name' | t }}</label>
            <input
              type="text"
              id="address-new-first-name"
              name="address[first_name]"
              class="addresses-page__input"
              autocomplete="given-name"
              value="{{ form.first_name }}"
            >
          </div>

          <div class="addresses-page__field">
            <label for="address-new-last-name" class="addresses-page__label">{{ 'customer.addresses.last_name' | t }}</label>
            <input
              type="text"
              id="address-new-last-name"
              name="address[last_name]"
              class="addresses-page__input"
              autocomplete="family-name"
              value="{{ form.last_name }}"
            >
          </div>

          <div class="addresses-page__field">
            <label for="address-new-company" class="addresses-page__label">{{ 'customer.addresses.company' | t }}</label>
            <input
              type="text"
              id="address-new-company"
              name="address[company]"
              class="addresses-page__input"
              autocomplete="organization"
              value="{{ form.company }}"
            >
          </div>

          <div class="addresses-page__field addresses-page__field--full">
            <label for="address-new-address1" class="addresses-page__label">{{ 'customer.addresses.address1' | t }}</label>
            <input
              type="text"
              id="address-new-address1"
              name="address[address1]"
              class="addresses-page__input"
              autocomplete="address-line1"
              value="{{ form.address1 }}"
              required
            >
          </div>

          <div class="addresses-page__field addresses-page__field--full">
            <label for="address-new-address2" class="addresses-page__label">{{ 'customer.addresses.address2' | t }}</label>
            <input
              type="text"
              id="address-new-address2"
              name="address[address2]"
              class="addresses-page__input"
              autocomplete="address-line2"
              value="{{ form.address2 }}"
            >
          </div>

          <div class="addresses-page__field">
            <label for="address-new-city" class="addresses-page__label">{{ 'customer.addresses.city' | t }}</label>
            <input
              type="text"
              id="address-new-city"
              name="address[city]"
              class="addresses-page__input"
              autocomplete="address-level2"
              value="{{ form.city }}"
              required
            >
          </div>

          <div class="addresses-page__field">
            <label for="address-new-country" class="addresses-page__label">{{ 'customer.addresses.country' | t }}</label>
            <select
              id="address-new-country"
              name="address[country]"
              class="addresses-page__select"
              autocomplete="country"
              data-address-country-select
            >
              {{ all_country_option_tags }}
            </select>
          </div>

          <div class="addresses-page__field">
            <label for="address-new-province" class="addresses-page__label">{{ 'customer.addresses.province' | t }}</label>
            <select
              id="address-new-province"
              name="address[province]"
              class="addresses-page__select"
              autocomplete="address-level1"
              data-address-province-select
            >
            </select>
          </div>

          <div class="addresses-page__field">
            <label for="address-new-zip" class="addresses-page__label">{{ 'customer.addresses.zip' | t }}</label>
            <input
              type="text"
              id="address-new-zip"
              name="address[zip]"
              class="addresses-page__input"
              autocomplete="postal-code"
              value="{{ form.zip }}"
            >
          </div>

          <div class="addresses-page__field">
            <label for="address-new-phone" class="addresses-page__label">{{ 'customer.addresses.phone' | t }}</label>
            <input
              type="tel"
              id="address-new-phone"
              name="address[phone]"
              class="addresses-page__input"
              autocomplete="tel"
              value="{{ form.phone }}"
            >
          </div>

          <div class="addresses-page__field addresses-page__field--full">
            <label class="addresses-page__checkbox-label">
              <input type="checkbox" name="address[default]" value="1">
              {{ 'customer.addresses.set_default' | t }}
            </label>
          </div>
        </div>

        <div class="addresses-page__form-actions">
          <button type="submit" class="btn btn--primary">{{ 'customer.addresses.add' | t }}</button>
        </div>
      {% endform %}
    </div>

    {%- comment -%} Existing addresses {%- endcomment -%}
    {%- if customer.addresses.size > 0 -%}
      <div class="addresses-page__list">
        <h2 class="addresses-page__section-title">{{ 'customer.addresses.existing_addresses' | t }}</h2>

        {%- for address in customer.addresses -%}
          <div class="addresses-page__address-card" id="address-{{ address.id }}">
            <div class="addresses-page__address-header">
              {%- if address == customer.default_address -%}
                <span class="addresses-page__default-badge">{{ 'customer.addresses.default' | t }}</span>
              {%- endif -%}
            </div>

            <address class="addresses-page__address-content">
              {{ address | format_address }}
            </address>

            {%- comment -%} Edit form {%- endcomment -%}
            <div class="addresses-page__edit-form" id="edit-address-{{ address.id }}" hidden>
              {% form 'customer_address', address %}
                <div class="addresses-page__form-grid">
                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-first-name" class="addresses-page__label">{{ 'customer.addresses.first_name' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-first-name"
                      name="address[first_name]"
                      class="addresses-page__input"
                      value="{{ address.first_name }}"
                    >
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-last-name" class="addresses-page__label">{{ 'customer.addresses.last_name' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-last-name"
                      name="address[last_name]"
                      class="addresses-page__input"
                      value="{{ address.last_name }}"
                    >
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-company" class="addresses-page__label">{{ 'customer.addresses.company' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-company"
                      name="address[company]"
                      class="addresses-page__input"
                      value="{{ address.company }}"
                    >
                  </div>

                  <div class="addresses-page__field addresses-page__field--full">
                    <label for="address-{{ address.id }}-address1" class="addresses-page__label">{{ 'customer.addresses.address1' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-address1"
                      name="address[address1]"
                      class="addresses-page__input"
                      value="{{ address.address1 }}"
                      required
                    >
                  </div>

                  <div class="addresses-page__field addresses-page__field--full">
                    <label for="address-{{ address.id }}-address2" class="addresses-page__label">{{ 'customer.addresses.address2' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-address2"
                      name="address[address2]"
                      class="addresses-page__input"
                      value="{{ address.address2 }}"
                    >
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-city" class="addresses-page__label">{{ 'customer.addresses.city' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-city"
                      name="address[city]"
                      class="addresses-page__input"
                      value="{{ address.city }}"
                      required
                    >
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-country" class="addresses-page__label">{{ 'customer.addresses.country' | t }}</label>
                    <select
                      id="address-{{ address.id }}-country"
                      name="address[country]"
                      class="addresses-page__select"
                      data-address-country-select
                      data-default="{{ address.country }}"
                    >
                      {{ all_country_option_tags }}
                    </select>
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-province" class="addresses-page__label">{{ 'customer.addresses.province' | t }}</label>
                    <select
                      id="address-{{ address.id }}-province"
                      name="address[province]"
                      class="addresses-page__select"
                      data-address-province-select
                      data-default="{{ address.province }}"
                    >
                    </select>
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-zip" class="addresses-page__label">{{ 'customer.addresses.zip' | t }}</label>
                    <input
                      type="text"
                      id="address-{{ address.id }}-zip"
                      name="address[zip]"
                      class="addresses-page__input"
                      value="{{ address.zip }}"
                    >
                  </div>

                  <div class="addresses-page__field">
                    <label for="address-{{ address.id }}-phone" class="addresses-page__label">{{ 'customer.addresses.phone' | t }}</label>
                    <input
                      type="tel"
                      id="address-{{ address.id }}-phone"
                      name="address[phone]"
                      class="addresses-page__input"
                      value="{{ address.phone }}"
                    >
                  </div>

                  <div class="addresses-page__field addresses-page__field--full">
                    <label class="addresses-page__checkbox-label">
                      <input type="checkbox" name="address[default]" value="1" {% if address == customer.default_address %}checked{% endif %}>
                      {{ 'customer.addresses.set_default' | t }}
                    </label>
                  </div>
                </div>

                <div class="addresses-page__form-actions">
                  <button type="submit" class="btn btn--primary">{{ 'customer.addresses.update' | t }}</button>
                  <button type="button" class="btn btn--ghost" data-action="cancel-edit" data-address-id="{{ address.id }}">
                    {{ 'customer.addresses.cancel' | t }}
                  </button>
                </div>
              {% endform %}
            </div>

            <div class="addresses-page__address-actions">
              <button
                type="button"
                class="btn btn--ghost btn--sm"
                data-action="edit-address"
                data-address-id="{{ address.id }}"
              >
                {{ 'customer.addresses.edit' | t }}
              </button>
              <button
                type="button"
                class="btn btn--ghost btn--sm addresses-page__delete-btn"
                data-action="delete-address"
                data-confirm-message="{{ 'customer.addresses.delete_confirm' | t }}"
                data-address-url="/account/addresses/{{ address.id }}"
              >
                {{ 'customer.addresses.delete' | t }}
              </button>
            </div>
          </div>
        {%- endfor -%}
      </div>
    {%- endif -%}

  </div>
</section>

{% schema %}
{
  "name": "Addresses page",
  "tag": "section",
  "class": "section-main-addresses",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:sections.main_addresses.settings.heading.label",
      "default": "Your Addresses"
    }
  ]
}
{% endschema %}
